<lms>
    <modulesToEnable logLevel="WARN">
        <if notSet="files">
            <module>mavlink_usb_importer</module>
        </if>
        <module>data_to_mavlink</module>
        <module>mavlink_to_data</module>
        <if set="mavlink_logger">
            <module>mavlink_logger</module>
            <module>mavlink_csv_logger</module>
        </if>
        <module>rgb_lights_controller</module>
    </modulesToEnable>
    <service name="USB_RESET" lib="usb_reset_service" class="UsbResetService">
        <config>
            <path>/usr/bin/usb-reset</path>
        </config>
    </service>
    <service name="TIMESTAMP_INTERPOLATOR" lib="timestamp_interpolator_service" class="TimestampInterpolatorService">
    </service>
    <module name="rgb_lights_controller" lib="rgb_lights_controller" class="RgbLights">
        <channelMapping from="STREET_OBJECTS" to="ENVIRONMENT_OBSTACLE"/>
        <config>
            <pongSpeed>10</pongSpeed>
            <snakeSpeed>20</snakeSpeed>
            <rainbowSpeed>2</rainbowSpeed>
        </config>
    </module>
    <module name="mavlink_usb_importer" lib="mavlink_usb_importer" class="mavlink_usb_importer">
        <config>
            <path>/dev/ttyACM0</path>
        </config>
        <config user="odroid">
            <path>/dev/senseboard</path>
        </config>
    </module>
    <module name="mavlink_to_data" lib="mavlink_to_data" class="MavlinkToData">
        <name>mavlink_to_data</name>
        <channelMapping priority="10" from="CAR" to="CAR"/>
        <config>
            <!--
            <sensor_timebase>fixed</sensor_timebase>
            <sensor_timebase_tickrate>100</sensor_timebase_tickrate>
            -->

            <!-- IMU -->
            <imu_0>IMU</imu_0>
            <!-- VARIANCES (@1khz) -->
            <imu_0_acc_cov_xx>0.5</imu_0_acc_cov_xx>
            <imu_0_acc_cov_yy>1.5</imu_0_acc_cov_yy>
            <imu_0_gyro_cov_zz>0.025</imu_0_gyro_cov_zz>

            <!-- BIASES -->
            <imu_0_acc_bias_x>0</imu_0_acc_bias_x>
            <imu_0_acc_bias_y>0</imu_0_acc_bias_y>
            <imu_0_acc_bias_z>0</imu_0_acc_bias_z>
            <imu_0_gyro_bias_x>0</imu_0_gyro_bias_x>
            <imu_0_gyro_bias_y>0</imu_0_gyro_bias_y>
            <imu_0_gyro_bias_z>0</imu_0_gyro_bias_z>

            <!-- HALL SENSOR -->
            <odometer_0>HALL</odometer_0>
            <odometer_0_velo_cov_xx>0.1</odometer_0_velo_cov_xx>

            <!-- MOUSE FRONT -->
            <odometer_1>MOTION_FRONT</odometer_1>
            <!-- MOUSE REAR -->
            <odometer_2>MOTION_REAR</odometer_2>

            <!-- LIDAR -->
            <distance_0>LIDAR</distance_0>
            <LIDAR_x>0.14</LIDAR_x>
            <LIDAR_y>-0.07</LIDAR_y>
            <LIDAR_dir>-90</LIDAR_dir>
            <!-- TOF FRONT -->
            <distance_1>TOF_FRONT</distance_1>
            <!-- TOF_REAR -->
            <distance_2>TOF_REAR</distance_2>
        </config>
    </module>
    <module name="data_to_mavlink" lib="data_to_mavlink" class="CarToMavlink"/>

    <if set="mavlink_logger">
        <module name="mavlink_logger" lib="channel_logger" class="">
            <config>
                <dataChannels>MAVLINK_IN</dataChannels>
            </config>
        </module>
        <module name="mavlink_csv_logger" lib="mavlink_csv_logger" class="MavlinkCsvLogger">
            <config user="odroid">
                <channel>MAVLINK_IN</channel>
            </config>
        </module>
    </if>
    <if set="files">
        <module name="mavlink_player" lib="channel_loader" class="ChannelLoader"/>
    </if>

    <if set="mavlink_debug">
        <module name="mavlink_debug_out" lib="mavlink_debug" class="umavlinkudebug">
            <channelMapping from="CHANNEL" to="MAVLINK_OUT"/>
        </module>
        <module name="mavlink_debug_in" lib="mavlink_debug" class="umavlinkudebug">
            <channelMapping from="CHANNEL" to="MAVLINK_IN"/>
        </module>
    </if>
</lms>
